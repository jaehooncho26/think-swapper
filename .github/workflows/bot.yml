name: Flip-Flop Trader
on:
  schedule:
    - cron: "*/10 * * * *"     # every 10 minutes; change to */30 for 30m
  workflow_dispatch: {}         # manual "Run workflow" button
jobs:
  trade:
    runs-on: ubuntu-latest
    permissions:
      contents: read
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: '20'
      - run: npm i @gala-chain/gswap-sdk
      - name: Run one tick
        env:
          # Secrets (repo → Settings → Secrets and variables → Actions)
          WALLET_ADDRESS: ${{ secrets.WALLET_ADDRESS }}
          PRIVATE_KEY:    ${{ secrets.PRIVATE_KEY }}     # 0x… GalaChain key

          # Variables (optional defaults; can edit in repo → Settings → Variables)
          DRY_RUN:        "false"                        # set "true" to test without sending
          BOT_INTERVAL_MIN: "10"                         # used only when not in 'once' mode
          BOT_USD_CENTS:  ${{ vars.BOT_USD_CENTS || 100 }}  # 100 = $1
          SLIPPAGE_BPS:   ${{ vars.SLIPPAGE_BPS || 50 }}
          MIN_PROFIT_BPS: ${{ vars.MIN_PROFIT_BPS || 10 }}
        run: node bot.js once
